#!/bin/bash
python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

#!/bin/bash
python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=2000 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=2000 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

#!/bin/bash
python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/llama_3b_civil_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=1000 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="lighteval/civil_comments_helm" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results/qwen3_4b_civil_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_civil/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=1000 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

#!/bin/bash
python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="llama_3b" \
    --num_test_examples=400 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/zero_shot" \
    --bias_type="race"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/zero_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/few_shot" \
    --bias_type="race"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/few_shot" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_imagination" \
    --bias_type="race"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_instruction" \
    --bias_type="race"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="race" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_race_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="race" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="race" \
    --model_type="qwen3_4b" \
    --num_test_examples=400 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

#!/bin/bash
python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="llama_3b" \
    --num_test_examples=800 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/zero_shot" \
    --bias_type="gender"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/zero_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/zero_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/few_shot" \
    --bias_type="gender"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/few_shot" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/few_shot" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_imagination" \
    --bias_type="gender"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_imagination" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_imagination" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=500 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_instruction" \
    --bias_type="gender"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=500 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_instruction" \
    --baseline="pad" \
    --bias_type="gender" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_gender_val_500/fairness_instruction" \
    --split="val" \
    --bias_type="gender" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="gender" \
    --model_type="qwen3_4b" \
    --num_test_examples=800 \
    --num_val_examples=500 \
    --test_seed=-1 \
    --val_seed=42

#!/bin/bash
python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=5

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=5

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=5

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=6

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=6

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=6

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=7

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=7

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=7

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=8

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=8

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=8

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=9

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=9

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=9

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=20 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=20 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_20/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=20 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=3

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=3

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=3

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=4

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=4

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=4

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=50 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=50 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_50/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=50 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=1

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=1

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=1

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=2

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=2

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=2

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=100 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=100 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_100/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=100 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="meta-llama/Llama-3.2-3B-Instruct" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/llama_3b_jigsaw_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="llama_3b" \
    --num_test_examples=200 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/zero_shot" \
    --bias_type="religion"\
    --prompt_type="zero_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/zero_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="zero_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/zero_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/few_shot" \
    --bias_type="religion"\
    --prompt_type="few_shot" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/few_shot" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="few_shot" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/few_shot" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_imagination" \
    --bias_type="religion"\
    --prompt_type="fairness_imagination" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_imagination" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_imagination" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_imagination" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m fairness_evaluation.compute_fairness_results \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --batch_size=1 \
    --max_seq_length=512 \
    --num_examples=200 \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_instruction" \
    --bias_type="religion"\
    --prompt_type="fairness_instruction" \
    --shuffle \
    --seed=42

python -m explanation_generation.gen_explanation_decoder \
    --dataset_name="google/jigsaw_unintended_bias" \
    --split="val" \
    --split_ratio="8, 2" \
    --model_dir="Qwen/Qwen3-4B" \
    --num_labels=2 \
    --batch_size=1 \
    --max_length=512 \
    --num_examples=200 \
    --methods="IntegratedGradients" \
    --output_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_instruction" \
    --baseline="pad" \
    --bias_type="religion" \
    --prompt_type="fairness_instruction" \
    --only_predicted_class \
    --shuffle \
    --seed=42

python -m sensitive_attribution_extraction.extract_sensitive_token_attribution \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_reliance_statistics \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results/qwen3_4b_jigsaw_religion_val_200/fairness_instruction" \
    --split="val" \
    --bias_type="religion" \
    --methods="IntegratedGradients"

python -m model_selection.compute_model_selection_correlation \
    --results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw" \
    --val_results_dir="/scratch/yifwang/fairness_x_explainability/decoder_results_jigsaw/val_results" \
    --methods="IntegratedGradients" \
    --experiment_type=decoder \
    --bias_type="religion" \
    --model_type="qwen3_4b" \
    --num_test_examples=200 \
    --num_val_examples=200 \
    --test_seed=-1 \
    --val_seed=42

